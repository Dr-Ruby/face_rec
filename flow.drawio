<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0" version="28.2.3">
  <diagram name="Page-1" id="sXvLRMKk7N3Y5ESBkTru">
    <mxGraphModel dx="3114" dy="1075" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1200" pageHeight="1920" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="8-0KFQB9ylwlBhoY2naG-1" value="Start" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-360" y="391.02000000000004" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-2" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-250" y="771.0200000000001" as="sourcePoint" />
            <mxPoint x="-300" y="481.02000000000004" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-5" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-3" target="8-0KFQB9ylwlBhoY2naG-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-3" value="Train skin + face model (offline)" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-360" y="481.02000000000004" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-7" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-4" target="8-0KFQB9ylwlBhoY2naG-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-4" value="Save trained model to .mat file" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-360" y="571.0200000000001" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-15" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-6" target="8-0KFQB9ylwlBhoY2naG-14">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-6" value="Load model and test image (online)" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-360" y="661.0200000000001" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-8" value="" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.annotation_2;align=left;labelPosition=right;pointerEvents=1;" vertex="1" parent="1">
          <mxGeometry x="-410" y="481.02000000000004" width="40" height="150" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-13" value="Training" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.delay;whiteSpace=wrap;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="-510" y="526.0200000000001" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-17" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-14" target="8-0KFQB9ylwlBhoY2naG-16">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-14" value="Detect faces in test image" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-360" y="751.0200000000001" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-16" value="Display detections" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-360" y="841.0200000000001" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-19" value="Detecting" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.delay;whiteSpace=wrap;fillColor=#0050ef;fontColor=#ffffff;strokeColor=#001DBC;" vertex="1" parent="1">
          <mxGeometry x="-510" y="708.44" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-20" value="Training" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.delay;whiteSpace=wrap;rotation=0;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" vertex="1" parent="1">
          <mxGeometry x="-110" y="68.28" width="120" height="71.72" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-25" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-21" target="8-0KFQB9ylwlBhoY2naG-24">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-21" value="Set training parameters&#xa;Â (histogram bins, template size, alpha grid, etc.)" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-140" y="161.72" width="180" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-24" value="&lt;div&gt;Initialize accumulators&lt;/div&gt;&lt;div&gt;&amp;nbsp;(color histograms, area list, y-position list, template sum)&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-140" y="251.72" width="180" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-29" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-26" target="8-0KFQB9ylwlBhoY2naG-28">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-26" value="For a Image" style="verticalLabelPosition=middle;verticalAlign=middle;html=1;shape=trapezoid;perimeter=trapezoidPerimeter;whiteSpace=wrap;size=0.23;arcSize=10;flipV=1;labelPosition=center;align=center;" vertex="1" parent="1">
          <mxGeometry x="-100" y="331.72" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-27" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-24" target="8-0KFQB9ylwlBhoY2naG-26">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint y="481.72" as="sourcePoint" />
            <mxPoint x="50" y="431.72" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-31" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-28" target="8-0KFQB9ylwlBhoY2naG-30">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-28" value="&lt;div&gt;Build RGB + HSV color histograms&amp;nbsp;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;for skin vs. background&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-110" y="431.72" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-33" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-30" target="8-0KFQB9ylwlBhoY2naG-32">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-30" value="&lt;div&gt;Accumulate color histograms&amp;nbsp;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;across all training images&lt;/span&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-110" y="521.72" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-35" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-32" target="8-0KFQB9ylwlBhoY2naG-34">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-32" value="&lt;div&gt;Extract labeled face regions&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&amp;nbsp;using the ground-truth mask&lt;/span&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-110" y="611.72" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-43" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-34" target="8-0KFQB9ylwlBhoY2naG-42">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-34" value="&lt;div&gt;Update statistics:&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&amp;nbsp;face areas,&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;vertical positions,&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&amp;nbsp;average face template (cropped, resized, masked)&lt;/span&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-160" y="701.72" width="220" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-36" value="" style="endArrow=none;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-34">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint y="591.72" as="sourcePoint" />
            <mxPoint x="110" y="731.72" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-37" value="" style="endArrow=classic;html=1;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="110" y="731.72" as="sourcePoint" />
            <mxPoint x="110" y="581.72" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-38" value="Next Image" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="70" y="521.72" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-40" value="" style="endArrow=classic;html=1;rounded=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" target="8-0KFQB9ylwlBhoY2naG-26">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="110" y="361.72" as="sourcePoint" />
            <mxPoint x="50" y="541.72" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-41" value="" style="endArrow=none;html=1;rounded=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-38">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint y="591.72" as="sourcePoint" />
            <mxPoint x="110" y="361.72" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-45" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-42" target="8-0KFQB9ylwlBhoY2naG-44">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-42" value="&lt;div&gt;Smooth and normalize color histograms&lt;/div&gt;&lt;div&gt;&amp;nbsp;to obtain probability models;&lt;/div&gt;&lt;div&gt;&lt;div&gt;Compute log-likelihood models&lt;/div&gt;&lt;div&gt;&amp;nbsp;for skin vs. background (RGB + HSV);&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;Tune alpha threshold:&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&amp;nbsp;evaluate classification error on training pixels&lt;/span&gt;&lt;/div&gt;&lt;div&gt;and choose best alpha;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;Compute geometric priors:&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;area statistics&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;and vertical position histogram&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-160" y="801.72" width="220" height="160" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-47" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-44" target="8-0KFQB9ylwlBhoY2naG-46">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-44" value="&lt;div&gt;Normalize average face template&lt;/div&gt;&lt;div&gt;&amp;nbsp;(final face template + mask)&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-160" y="1001.72" width="220" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-49" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-46" target="8-0KFQB9ylwlBhoY2naG-48">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-46" value="&lt;div&gt;Pack everything into model struct&lt;/div&gt;&lt;div&gt;&amp;nbsp;(histograms, log-likelihoods, priors, template, errors)&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-160" y="1100" width="220" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-48" value="Save model to face_model.mat" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-160" y="1200" width="220" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-51" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-50" target="8-0KFQB9ylwlBhoY2naG-1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-50" value="Global Project Flow" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.delay;whiteSpace=wrap;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="-350" y="294.3" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-58" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-52" target="8-0KFQB9ylwlBhoY2naG-54">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-52" value="Detecting" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.delay;whiteSpace=wrap;fillColor=#0050ef;fontColor=#ffffff;strokeColor=#001DBC;" vertex="1" parent="1">
          <mxGeometry x="250" y="68.28" width="120" height="71.72" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-55" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-53" target="8-0KFQB9ylwlBhoY2naG-54">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-53" value="Load test image and convert to RGB + grayscale formats" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="250" y="164.15" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-57" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-54" target="8-0KFQB9ylwlBhoY2naG-56">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-54" value="&lt;div&gt;Apply trained skin model:&amp;nbsp;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;compute skin likelihood map;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&amp;nbsp;threshold + HSV gating to obtain skin mask&lt;/span&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="180" y="251.72" width="260" height="58.28" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-62" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-56" target="8-0KFQB9ylwlBhoY2naG-61">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-56" value="&lt;div&gt;Clean up skin mask with morphology:&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;remove small noise;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&amp;nbsp;merge nearby regions;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;fill holes&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="180" y="340" width="260" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-60" value="" style="endArrow=none;html=1;rounded=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-21" target="8-0KFQB9ylwlBhoY2naG-20">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="160" y="330" as="sourcePoint" />
            <mxPoint x="210" y="280" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-64" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-61" target="8-0KFQB9ylwlBhoY2naG-63">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-61" value="&lt;div&gt;Connected component analysis on skin mask&amp;nbsp;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;to get candidate blobs;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;Extract blob properties:&amp;nbsp;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;area;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;bounding box, and&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;center position&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="180" y="431.72" width="260" height="78.28" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-63" value="Load area statistics,&amp;nbsp;vertical position statistics, and&amp;nbsp;average face template &amp;amp; mask from model" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="180" y="540" width="260" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-65" value="&lt;span style=&quot;color: rgb(255, 255, 255); text-wrap-mode: nowrap;&quot;&gt;First Pass:filter blobs by size, shape, and fill&lt;/span&gt;" style="swimlane;whiteSpace=wrap;html=1;fillColor=#d80073;fontColor=#ffffff;strokeColor=#A50040;" vertex="1" parent="1">
          <mxGeometry x="180" y="630.08" width="260" height="113.28" as="geometry">
            <mxRectangle x="400" y="630.08" width="270" height="30" as="alternateBounds" />
          </mxGeometry>
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-66" value="&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;filter by vertical position prior;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;evaluate skin density inside region;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;compare cropped patch with face template;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;keep strong face candidates&lt;/span&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="8-0KFQB9ylwlBhoY2naG-65">
          <mxGeometry x="5" y="33.28" width="250" height="70" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-70" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-63" target="8-0KFQB9ylwlBhoY2naG-65">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="250" y="580" as="sourcePoint" />
            <mxPoint x="300" y="530" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-71" value="&lt;div&gt;Estimate &quot;row band&quot;&amp;nbsp;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;where faces are likely located&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&amp;nbsp;based on strong candidates, and&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;set adaptive constraints for rescue stage&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;using strong candidates&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="180" y="770" width="260" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-73" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-65" target="8-0KFQB9ylwlBhoY2naG-71">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="250" y="770" as="sourcePoint" />
            <mxPoint x="300" y="720" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-74" value="Second Pass:&amp;nbsp;rescue additional faces" style="swimlane;whiteSpace=wrap;html=1;fillColor=#d80073;fontColor=#ffffff;strokeColor=#A50040;" vertex="1" parent="1">
          <mxGeometry x="180" y="860" width="260" height="100" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-75" value="scan remaining blobs inside row band;&lt;div&gt;filter by relaxed geometric constraints;&lt;/div&gt;&lt;div&gt;accept plausible extra faces&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="8-0KFQB9ylwlBhoY2naG-74">
          <mxGeometry x="15" y="30.00000000000003" width="230" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-76" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-71" target="8-0KFQB9ylwlBhoY2naG-74">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="300" y="860" as="sourcePoint" />
            <mxPoint x="350" y="810" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-80" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-77" target="8-0KFQB9ylwlBhoY2naG-79">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-77" value="Merge overlapping / vertically stacked detections to remove duplicate boxes for the same person;&amp;nbsp;&lt;span style=&quot;background-color: transparent;&quot;&gt;Draw final bounding boxes on the image&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&amp;nbsp;and prepare output&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="180" y="980" width="260" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-78" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-74" target="8-0KFQB9ylwlBhoY2naG-77">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="300" y="860" as="sourcePoint" />
            <mxPoint x="350" y="810" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-79" value="&lt;div&gt;Return list of faces&lt;/div&gt;&lt;div&gt;&amp;nbsp;(bounding box + center)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="250" y="1061.72" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-84" value="" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.annotation_2;align=left;labelPosition=right;pointerEvents=1;" vertex="1" parent="1">
          <mxGeometry x="-410" y="664.3000000000001" width="40" height="148.28" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-85" value="" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.annotation_2;align=left;labelPosition=right;pointerEvents=1;rotation=-180;" vertex="1" parent="1">
          <mxGeometry x="-230" y="754.62" width="20" height="56.88" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-86" value="Skin model application" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.delay;whiteSpace=wrap;rotation=-1;fillColor=#a20025;fontColor=#ffffff;strokeColor=#6F0000;" vertex="1" parent="1">
          <mxGeometry x="-510" y="962.58" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-88" value="Skin model application" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.delay;whiteSpace=wrap;fillColor=#a20025;fontColor=#ffffff;strokeColor=#6F0000;" vertex="1" parent="1">
          <mxGeometry x="550" y="68.28" width="120" height="74.14" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-92" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-89" target="8-0KFQB9ylwlBhoY2naG-91">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-89" value="Input image and trained model,&amp;nbsp;Convert image to RGB + HSV" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="510" y="164" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-90" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-88" target="8-0KFQB9ylwlBhoY2naG-89">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="600" y="300" as="sourcePoint" />
            <mxPoint x="650" y="250" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-94" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-91" target="8-0KFQB9ylwlBhoY2naG-93">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-91" value="&amp;nbsp;Map pixels into RGB histogram bins&amp;nbsp;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;Map pixels into HSV histogram bins&lt;/span&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="510" y="250" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-96" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-93" target="8-0KFQB9ylwlBhoY2naG-95">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-93" value="&lt;div&gt;Look up combined skin log-likelihood&lt;/div&gt;&lt;div&gt;&amp;nbsp;from trained model&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="510" y="340" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-98" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-95" target="8-0KFQB9ylwlBhoY2naG-97">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-95" value="Threshold likelihood to create bright skin mask" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="510" y="431.72" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-100" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-97" target="8-0KFQB9ylwlBhoY2naG-99">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-97" value="&lt;div&gt;Apply HSV-based gating&lt;/div&gt;&lt;div&gt;&amp;nbsp;to remove obvious non-skin regions&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="510" y="530" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-99" value="Output final skin mask + log likelihood image" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="510" y="628.44" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-101" value="" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.annotation_2;align=left;labelPosition=right;pointerEvents=1;" vertex="1" parent="1">
          <mxGeometry x="-410" y="841.0200000000001" width="40" height="61.56" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-102" value="Visualization" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.delay;whiteSpace=wrap;fillColor=#fad9d5;strokeColor=#ae4132;" vertex="1" parent="1">
          <mxGeometry x="-510" y="842.58" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-103" value="Visualization" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.delay;whiteSpace=wrap;fillColor=#fad9d5;strokeColor=#ae4132;" vertex="1" parent="1">
          <mxGeometry x="555" y="718.44" width="110" height="68.44" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-108" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-105" target="8-0KFQB9ylwlBhoY2naG-107">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-105" value="Load original image" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="510" y="808.44" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-106" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-103" target="8-0KFQB9ylwlBhoY2naG-105">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="640" y="560" as="sourcePoint" />
            <mxPoint x="690" y="510" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-110" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-107" target="8-0KFQB9ylwlBhoY2naG-109">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-107" value="&lt;div&gt;Overlay bounding boxes and centers&lt;/div&gt;&lt;div&gt;&amp;nbsp;for each detected face&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="510" y="901.72" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-109" value="Display annotated image with face count" style="whiteSpace=wrap;html=1;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="510" y="990" width="200" height="60" as="geometry" />
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-111" value="" style="endArrow=none;html=1;rounded=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-85">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="120" y="660" as="sourcePoint" />
            <mxPoint x="-210" y="990" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="8-0KFQB9ylwlBhoY2naG-112" value="" style="endArrow=none;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="1" source="8-0KFQB9ylwlBhoY2naG-86">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="120" y="660" as="sourcePoint" />
            <mxPoint x="-210" y="990" as="targetPoint" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
